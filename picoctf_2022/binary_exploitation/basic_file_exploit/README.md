# picoCTF 2022
## basic-file-exploit

> AUTHOR: WILL HONG
>
> Description
>
> The program provided allows you to write to a file and read what you wrote from it. Try playing around with it and see if you can break it!
>
> Connect to the program with netcat:
>
> `$ nc saturn.picoctf.net 49700`
>
> The program's source code with the flag redacted can be downloaded [here](https://github.com/03npan/ctf-write-ups/blob/main/picoctf-2022/binary_exploitation/basic_file_exploit/program-redacted.c).

Tags: *Binary Exploitation*

## Summary

Provide appropriate input in correct order to get program to print the flag.

## Detailed Solution

First let's investigate the provided file. We see the redacted flag variable declared at the top. It is printed from the `data_read` function if we input '0' when asked for the entry number. Looking in `main` we see that `data_read` is called if we select the second option and input already exists. This probably means we will need to enter data using option first before we can `data_read` to run.

Connect using the provided command. If we try to do option 2 to start, we get: `No data yet`, as expected. Let's us option 1 first, input some data of some length, and then try option 2. Now we get the prompt asking for the entry number, so let's enter '0'. The flag is then printed.

Flag: `picoCTF{M4K3_5UR3_70_CH3CK_Y0UR_1NPU75_9F68795F}`